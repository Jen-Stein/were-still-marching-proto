<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR.js — Camera Black Screen FIX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <!-- A-Frame + AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.3.2/aframe/build/aframe-ar.min.js"></script>

  <style>
    html, body { margin:0; height:100%; width:100%; overflow:hidden; background:#000; font-family:system-ui, Arial, sans-serif; }

    /* 1) Camera video BELOW the canvas */
    video#arjs-video, video.arjs-video, video[playsinline]{
      position:fixed !important;
      top:0; left:0;
      width:100vw !important; height:100vh !important;
      object-fit:cover !important;
      z-index:0 !important;               /* BELOW */
      background:#000;
      pointer-events:none;
    }

    /* 2) WebGL canvas ABOVE video — transparent because renderer alpha:true */
    canvas.a-canvas, .a-canvas canvas{
      position:fixed !important;
      top:0; left:0;
      width:100vw !important; height:100vh !important;
      z-index:1 !important;               /* ABOVE */
      display:block !important;
      pointer-events:none;
      /* no background here! keep it transparent */
    }

    a-scene{
      position:fixed !important;
      inset:0 !important;
      width:100vw !important; height:100vh !important;
      /* No background color on the scene either */
    }

    #status{
      position:fixed; left:8px; bottom:8px; z-index:10;
      background:rgba(0,0,0,.6); color:#0f0; padding:6px 8px; border-radius:6px;
      font:12px/1.3 monospace;
    }
  </style>
</head>
<body>
<div id="status">loading…</div>

<a-scene
  embedded
  vr-mode-ui="enabled:false"

  <!-- IMPORTANT: alpha:true makes the canvas transparent -->
  renderer="antialias:true; alpha:true; precision:mediump"

  arjs="sourceType:webcam; facingMode:environment; detectionMode:mono; debugUIEnabled:false"
>
  <!-- Use BARCODE #5 since that’s what detected for you earlier -->
  <a-marker type="barcode" value="5" id="marker" emitevents="true">
    <!-- Big, unlit cube so it’s obvious -->
    <a-box id="cube"
           position="0 1 0"
           width="2" height="2" depth="2"
           material="color:#FF00FF; shader:flat"
           visible="false"></a-box>
  </a-marker>

  <!-- If you want HIRO instead, swap the marker above for this:
  <a-marker type="pattern" emitevents="true"
            url="https://raw.githubusercontent.com/jeromeetienne/AR.js/master/three.js/examples/marker-training/examples/pattern-files/pattern-hiro.patt">
    <a-box position="0 1 0" width="2" height="2" depth="2"
           material="color:#FF00FF; shader:flat" visible="false"></a-box>
  </a-marker>
  -->

  <a-entity camera></a-entity>
</a-scene>

<script>
  const st    = document.getElementById('status');
  const m     = document.getElementById('marker');
  const cube  = document.getElementById('cube');

  window.addEventListener('load', ()=>{
    st.textContent = 'Point at the printed BARCODE #5… (you should SEE the camera now)';
  });

  m.addEventListener('markerFound', ()=>{
    cube.setAttribute('visible','true');
    st.textContent = 'MARKER FOUND ✅ (cube shown)';
  });

  m.addEventListener('markerLost', ()=>{
    cube.setAttribute('visible','false');
    st.textContent = 'Point at the printed marker…';
  });
</script>
</body>
</html>
