<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>HIRO — Minimal Detector (seam fix)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />

  <!-- A-Frame + AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.3.2/aframe/build/aframe-ar.min.js"></script>

  <style>
    html, body { margin:0; height:100%; width:100%; overflow:hidden; background:#000; font-family:system-ui, Arial, sans-serif; }
    /* Kill right-edge line: overscan + tiny scale (strong setting) */
    video#arjs-video, video.arjs-video, video[playsinline]{
      position:fixed !important; top:0; left:-8px;
      width:calc(100dvw + 16px) !important; height:100dvh !important;
      object-fit:cover !important; z-index:0 !important; background:#000;
      transform:translateZ(0) scale(1.012); transform-origin:left center;
      pointer-events:none;
    }
    canvas.a-canvas, .a-canvas canvas{
      position:fixed !important; top:0; left:-8px;
      width:calc(100dvw + 16px) !important; height:100dvh !important;
      z-index:1 !important; display:block !important; pointer-events:none;
      transform:translateZ(0) scale(1.012); transform-origin:left center;
    }
    a-scene{ position:fixed !important; inset:0 !important; width:100dvw !important; height:100dvh !important; }
    #status{ position:fixed; left:8px; bottom:8px; z-index:5; background:rgba(0,0,0,.6); color:#0f0; font:12px/1.3 monospace; padding:6px 8px; border-radius:6px; }
  </style>
</head>
<body>
  <div id="status">loading…</div>

  <a-scene
    embedded
    vr-mode-ui="enabled:false"
    renderer="antialias:true; alpha:true; precision:mediump"
    arjs="
      sourceType: webcam;
      facingMode: environment;
      detectionMode: mono;
      patternRatio: 0.50;          /* default works best */
      debugUIEnabled: false;
      sourceWidth: 640; sourceHeight: 480;  /* keep it light = more reliable */
      displayWidth: 640; displayHeight: 480
    "
  >
    <!-- DIRECT HIRO pattern (no preset) -->
    <a-marker
      id="marker"
      type="pattern"
      emitevents="true"
      minConfidence="0.1"
      url="https://raw.githubusercontent.com/jeromeetienne/AR.js/master/three.js/examples/marker-training/examples/pattern-files/pattern-hiro.patt"
    >
      <!-- Huge, unlit magenta cube -->
      <a-box id="probe"
             position="0 0.5 0"
             width="0.7" height="0.7" depth="0.7"
             material="color:#FF00FF; shader:flat"
             visible="false"></a-box>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const statusEl = document.getElementById('status');
    const marker   = document.getElementById('marker');
    const probe    = document.getElementById('probe');

    window.addEventListener('load', () => {
      statusEl.textContent = 'Point at your PRINTED HIRO (fill 1/3 of screen, steady)…';
    });

    marker.addEventListener('markerFound', () => {
      probe.setAttribute('visible', 'true');
      statusEl.textContent = 'HIRO FOUND ✅';
    });
    marker.addEventListener('markerLost', () => {
      probe.setAttribute('visible', 'false');
      statusEl.textContent = 'Point at your PRINTED HIRO…';
    });
  </script>
</body>
</html>
